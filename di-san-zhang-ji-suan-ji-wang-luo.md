1.HTTP请求报文与响应报文

HTTP报文是由一行一行的简单字符串组成的。HTTP报文都是纯文本，不是二进制代码,所以人们可以很方便地对其进行读写

HTTP 是构建在TCP/IP 协议之上，默认的端口号是80 是应用层协议

HTTP 报文包括以下三个部分：

起始行

报文的第一行就是起始行,在请求报文中用来说明要做些什么,在响应报文中说明出现了什么情况。

首部字段

起始行后面有零个或多个首部字段。每个首部字段都包含一个名字和一个值,为了便于解析,两者之间用冒号\\(:\\)来分隔。首部以一个空行结束。添加一个首部字段和添加新行一样简单。

主体

空行之后就是可选的报文主体了,其中包含了所有类型的数据。请求主体中包括 了要发送给 Web 服务器的数据;响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化的,而主体则不同,主体中可以包含任意 的二进制数据\\(比如图片、视频、音轨、软件程序\\)。当然,主体中也可以包含 文本

**  1.1HTTP请求报文**

```
请求行、请求头部、空行、请求包体四个部分组成
```

![](/assets/import.png)

** a.请求行 **

请求行由**方法字段**、**URL 字段** 和**HTTP 协议版本**字段 3 个部分组成，他们之间使用空格隔开。常用的 HTTP 请求方法有 GET、POS

**GET：**

当客户端要从服务器中读取某个资源时，使用GET 方法

GET用于信息获取，而且应该是安全的 和 幂等的。

所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。

幂等的意味着对同一URL的多个请求应该返回同样的结果。

使用GET方法时，请求参数和对应的值附加在 URL 后面，利用一个问号\(“?”\)代表URL 的结尾与请求参数的开始，传递参数长度受限制，因此GET方法不适合用于上传数据。GET 方法用于获取数据，通过GET方法来获取网页时，参数会显示在浏览器地址栏上，因此保密性很差。

get传送的数据量较小，不能大于2KB

GET请求报文示例

```
 GET /books/?sex=man&name=Professional HTTP/1.1
 Host: www.example.com
 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
 Gecko/20050225 Firefox/1.0.1
 Connection: Keep-Alive
```

**POST:**

客户端给服务器提供信息较多时可以使用POST 方法，POST 方法向服务器提交数据，比如完成表单数据的提交，将数据提交给服务器处理。POST 会附带用户数据，一般用于更新资源信息。POST 方法将请求参数封装在HTTP 请求数据中，而且长度没有限制，因为POST携带的数据，在HTTP的请求正文中，以名称/值的形式出现，可以传输大量数据。

POST传送的数据量较大，一般被默认为不受限制

POST请求报文示例

```
 POST / HTTP/1.1
 Host: www.example.com
 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)
 Gecko/20050225 Firefox/1.0.1
 Content-Type: application/x-www-form-urlencoded
 Content-Length: 40
 Connection: Keep-Alive

 sex=man&name=Professional
```

HTTP 协议中规定 POST 提交的数据必须在 body 部分中，但是协议中没有规定数据使用哪种编码方式或者数据格式。实际上，开发者完全可以自己决定消息主体的格式，只要最后发送的 HTTP 请求满足上面的格式就可以。

HTTP版本协议

HTTP1.0与HTTP1.1

1\)HTTP1.0 是短连接，HTTP1.1是长连接。 HTTP 1.0规定浏览器与服务器只保持短暂的连接，浏览器的每次请求都需要与服务器建立一个TCP连接，服务器完成请求处理后立即断开TCP连接，服务器不跟踪每个客户也不记录过去的请求。如果一个html包含多个图片或资源时需要多次与服务器建立连接。 HTTP 1.1支持持久连接，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟。一个包含有许多图像的网页文件的多个请求和应答可以在一个连接中传输，但每个单独的网页文件的请求和应答仍然需要使用各自的连接.HTTP 1.1采用了流水线的持久连接，即客户端不用等待上一次请求结果返回，就可以发出下一次请求，但服务器端必须按照接收到客户端请求的先后顺序依次回送响应结果，以保证客户端能够区分出每次请求的响应内容，这样也显著地减少了整个下载过程所需要的时间。 2\)HTTP 1.0不支持Host请求头字段，WEB浏览器无法使用主机头名来明确表示要访问服务器上的哪个WEB站点，这样就无法使用WEB服务器在同一个IP地址和端口号上配置多个虚拟WEB站点。在HTTP 1.1中增加Host请求头字段后，WEB浏览器可以使用主机头名来明确表示要访问服务器上的哪个WEB站点，这才实现了在一台WEB服务器上可以在同一个IP地址和端口号上使用不同的主机名来创建多个虚拟WEB站点。 3\)HTTP 1.1还提供了与身份认证、状态管理和Cache缓存等机制相关的请求头和响应头 4\)带宽优化。HTTP/1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了。例如，客户端只需要显示一个文档的部分内容，又比如下载大文件时需要支持断点续传功能，而不是在发生断连后不得不重新下载完整的包。 HTTP/1.1中在请求消息中引入了range头域，它允许只请求资源的某个部分。 5\) HTTP/1.1增加了OPTIONS方法，它允许客户端获取一个服务器支持的方法列表

[http://blog.csdn.net/forgotaboutgirl/article/details/6936982](http://blog.csdn.net/forgotaboutgirl/article/details/6936982)

**b.请求头部**

请求头部为请求报文添加了一些附加信息，由“名/值”对组成，每行一对，名和值之间使用冒号分隔。

请求头部通知服务器有关于客户端请求的信息，典型的请求头有：

| 请求头 | 含义 |
| :--- | :--- |
| User-Agent | 请求的浏览器类型 |
| Accept | 客户端可识别的响应内容类型列表，星号“ \* ”用于按范围将类型分组，用“_/_”指示可接受全部类型，用“ type/\* ”指示可接受 type 类型的所有子类型 |
| Accept-Language | 客户端可接受的自然语言 |
| Accept-Encoding | 客户端可接受的编码压缩格式 |
| Accept-Charset | 可接受的应答的字符集 |
| Host | 请求的主机名，允许多个域名同处一个IP 地址，即虚拟主机 |
| connection | 连接方式\(close或keepalive\) |
| Cookie | 存储于客户端扩展字段，向同一域名的服务端发送属于该域的cookie |

**c.空行**

最后一个请求头之后是一个空行，发送回车符和换行符，通知服务器以下不再有请求头。

**d.请求包体**

请求包体不在GET方法中使用，而是POST方法中使用。

POST方法适用于需要客户填写表单的场合。与请求包体相关的最常使用的是包体类型Content-Type和包体长度Content-Length。

Content-Type 和消息主体编码方式两部分

`application/x-www-form-urlencoded`： 最常见的 POST 数据提交方式。浏览器的原生表单，如果不设置 enctype 属性，那么最终就会以 application/x-www-form-urlencoded 方式提交数据。

`multipart/form-data`: 这又是一个常见的 POST 数据提交的方式。我们使用表单上传文件时，必须让 &lt;form&gt;表单的 enctype 等于 multipart/form-data

随着越来越多的 Web 站点，尤其是 WebApp，全部使用 Ajax 进行数据交互之后，我们完全可以定义新的数据提交方式，例如

`application/json`，`text/xml`，乃至 `application/x-protobuf` 这种二进制格式，只要服务器可以根据 `Content-Type`

和 `Content-Encoding`正确地解析出请求，都是没有问题的。

**1.2响应报文**

```
 HTTP 响应报文由状态行、响应头部、空行、响应包体4个部分组成
```

![](/assets/import1.png)

```
状态行由 HTTP 协议版本字段、状态码和状态码的描述文本3个部分组成，他们之间使用空格隔开。
```

a.**状态码：**

状态码由三位数字组成，第一位数字表示响应的类型，常用的状态码有五大类如下所示：

| **状态码** | 含义 |
| :--- | :--- |
| 1xx | 表示服务器已接收了客户端请求，客户端可继续发送请求 |
| 2xx | 表示服务器已成功接收到请求并进行处理 |
| 3xx | 表示服务器要求客户端重定向 |
| 4xx | 表示客户端的请求有非法内容 |
| 5xx | 表示服务器未能正常处理客户端的请求而出现意外错误 |

**常见的状态码举例：**

| **状态码** | 含义 |
| :--- | :--- |
| 200 OK | 客户端请求成功 |
| 400 Bad Request | 请求报文有语法错误 |
| 401 Unauthorized | 未授权 |
| 403 Forbidden | 服务器拒绝服务 |
| 404 Not Found | 请求的资源不存在 |
| 500 Internal Server Error | 服务器内部错误 |
| 503 Server Unavailable | 服务器临时不能处理客户端请求\(稍后可能可以\) |

**b.响应头部**

| 响应头 | 含义 |
| :--- | :--- |
| Location | Location响应报头域用于重定向接受者到一个新的位置 |
| Server Server | 响应报头域包含了服务器用来处理请求的软件信息及其版本 |
| Vary | 指示不可缓存的请求头列表 |
| Connection | 连接方式 |

**c.空行**

最后一个响应头部之后是一个空行，发送回车符和换行符，通知服务器以下不再有响应头部。

**d.响应包体**

服务器返回给客户端的文本信息。

计算机网络相关优秀的博客地址和参考资料：

[https://ttop5.gitbooks.io/illustration-http/content/chapter6.html](https://ttop5.gitbooks.io/illustration-http/content/chapter6.html)

[HTTP协议浅析\(中\)：请求报文和响应报文](http://blog.csdn.net/tennysonsky/article/details/53907261)

