##### 1.进程和线程的区别和联系

**进程**是操作系统的概念，每当我们执行一个程序时，对于操作系统来讲就创建了一个进程,在这个过程中，伴随着资源的分配和释放。可以认为进程是一个程序的一次执行过程。

**  线程**是进程中执行运算的最小单位，是进程中的一个实体，是被系统独立调度和分派的基本单位，线程自己不拥有系统资源，只拥有一点在运行中必不可少的资源，但它可与同属一个进程的其它线程共享进程所拥有的全部资源。

线程的三个特性：\(1\)**原子性**:即一个操作或者多个操作 要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行。\(2\)**可见性:**当多个线程访问同一个变量时，一个线程修改了这个变量的值，其他线程能够立即看得到修改的值。\(3\)**有序性**:程序执行的顺序按照代码的先后顺序执行。线程的有序性是指：在线程内部，所有的操作都是有序执行的，而在线程之间，因为工作内存和主内存同步的延迟，操作是乱序执行的

**线程与进程的联系:**

\(1\) 一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。 \(2\) 资源分配给进程，同一进程的所有线程共享该进程的所有资源。 \(3\) 处理机分给线程，即真正在处理机上运行的是线程。 \(4\) 线程在执行过程中，需要协作同步。不同进程的线程间要利用消息通信的办法实现同步。线程是指进程内的一个执行单元,也是进程内的可调度实体.

**线程与进程的区别:**

**1\)调度**：线程作为调度和分配的基本单位，进程作为拥有资源的基本单位 **2\)并发性:**不仅进程之间可以并发执行，同一个进程的多个线程之间也可并发执行 **3\)拥有资源:**进程是拥有资源的一个独立单位，线程不拥有系统资源，只拥有一点在运行中必不可少的资源，但它可与同属一个进程的其它线程共享进程所拥有的全部资源. **4\)系统开销:**在创建或撤消进程时，由于系统都要为之分配和回收资源，导致系统的开销明显大于创建或撤消线程时的开销。

**进程间的通信方式**：管道\( pipe）、信号量\( semophore \)、消息队列\( message queue \)、信号 \( sinal \)、共享内存\( shared memory \)、套接字\( socket \).

**线程间的通信方式**:锁机制：包括互斥锁、条件变量、读写锁

* * 互斥锁提供了以排他方式防止数据结构被并发修改的方法。
  * 读写锁允许多个线程同时读共享数据，而对写操作是互斥的。
  * 条件变量可以以原子的方式阻塞进程，直到某个特定条件为真为止。对条件的测试是在互斥锁的保护下进行的。条件变量始终与互斥锁一起使用。
* 信号量机制\(Semaphore\)：包括无名线程信号量和命名线程信号量

* 信号机制\(Signal\)：类似进程间的信号处理

  线程间的通信目的主要是用于线程同步，所以线程没有像进程通信中的用于数据交换的通信机制。

##### 2.死锁

死锁是指两个或两个以上的进程在执行过程中，由于竞争资源或者由于彼此通信而造成的一种阻塞的现象，若无外力作用，它们都将无法推进下去。

死锁产生的条件：**互斥条件:**一个资源每次只能被一个进程使用;**不可剥夺条件**:进程已获得的资源，在末使用完之前，不能强行剥夺;**请求与保持条件**:一个进程因请求资源而阻塞时，对已获得的资源保持不放;**循环等待条件**:若干进程之间形成一种头尾相接的循环等待资源关系。

银行家算法：避免死锁   资源有序分配法：预防死锁    资源分配图化简法：检测死锁         撤销进程法：解决死锁

[银行家算法](http://baike.baidu.com/view/93075.htm)（Banker's Algorithm）是一个避免死锁（Deadlock）的著名算法。 为保证资金的安全,银行家规定:

\(1\) 当一个顾客对资金的最大需求量不超过银行家现有的资金时就可接纳该顾客;

\(2\) 顾客可以分期贷款,但贷款的总数不能超过最大需求量;

\(3\) 当银行家现有的资金不能满足顾客尚需的贷款数额时,对顾客的贷款可推迟支付,但总能使顾客在有限的时间里得到贷款;

\(4\) 当顾客得到所需的全部资金后,一定能在有限的时间里归还所有的资金.

死锁预防

1. **破坏互斥条件**

   。允许某些进程\(线程\)同时访问某些资源，但有的资源不允许同时被访问如打印机等。

2. **破坏不可抢占条件**

   :即允许进程强行从占有者那里夺取某些资源。就是说，当一个进程已经占有某些资源，它又重新占有全部资源，以后再重新申请，它所释放的资源可以分配给其他进程。这种预防方法实现起来困难，会降低系统性能。

3. **破坏占有且申请条件**

   。可以实行预先分配策略，即进程在运行前一次性地向系统申请它所需要的全部资源。如果当前进程所需的全部资源得不到满足，则不分配任何资源。只有当系统能够满足当前的全部资源得到满足时，才一次性将所有申请的资源全部分配给该进程。由于运行的进程已占有了它所需的全部资源，所以不会发生占有资源又重新申请资源的现象，因此不会发生死锁。但是有以下缺点： 1\) 在许多情况下，一个进程在执行之前不可能知道它所需的全部资源。这是由于进程在执行时是动态的，不可预测的。 2）资源利用率低。无论所分配资源何时用到，一个进程只有在占有所需的全部资源后才能执行。即使有些资源最后才被该进程用到一次，但该进程在生存期间一直占有它们，造成长期占有。 3\) 降低了进程的并发性。因为资源有限，又加上存在浪费，能分配到所需全部资源的进程个数必然少了。

4. **破坏循环等待条件**

   。实行资源有序分配策略。采用这种策略即把资源事先分类编号，按号分配。所有进程对资源的请求必须严格按资源需要递增的顺序提出。进程占用小好资源，才能申请大号资源，就不会产生环路。这种策略与前面的策略相比，资源的利用率和系统吞吐量都有很大提高，但是也存在以下缺点： 1）限制了进程对资源的请求，同时系统给所有资源合理编号也是件困难事，并增加了系统开销。



